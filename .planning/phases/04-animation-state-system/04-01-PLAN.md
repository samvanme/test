# Plan 04-01: Animation & State System

## Objective

Build a state-expressive animation system that communicates AI agent behavior through purposeful motion. Create reusable components for thinking states, progress indicators, and confidence displays that enhance the demo experience while respecting the brutalist design philosophy.

## Execution Context

**Reference patterns from:**
- `src/components/VoiceDemo.jsx` — Waveform animation, ping indicators, brutalist card styling
- `src/styles/DESIGN-TOKENS.md` — Animation policy (functional motion only), reduced motion support
- `tailwind.config.js` — Existing keyframes (waveform, marquee)
- `src/index.css` — CSS variables, transition utilities, reduced motion media query

**Design decisions (from STATE.md):**
- Animation policy: Functional motion only (waveform, ping kept; aurora, float removed)
- Animations should explain, guide, or confirm — never decorate
- Reduced motion support required (@prefers-reduced-motion)
- Color restraint: Brand blue on CTAs/status only

## Context

Phase 3 completed the brutalist visual redesign. All sections use consistent typography, spacing, and color restraint. VoiceDemo already demonstrates functional animation patterns (waveform for audio state, ping for live status). Phase 4 expands this into a complete animation library for AI state visualization.

**Current animation inventory:**
- `animate-waveform` — Audio playback visualization (functional)
- `animate-ping` — Live status indicator (functional)
- `animate-marquee` — Scrolling content (not currently used)
- Hover transitions — Border, shadow, transform (fast, purposeful)

**What's needed for AI demo (Phase 5):**
- Thinking state visualization (AI processing)
- Progress indication (multi-step operations)
- Confidence display (AI certainty levels)
- State transitions (loading → active → complete)

## Tasks

### Task 1: Create animation utilities and CSS variables

**Goal**: Establish animation timing tokens and utility classes

**Changes:**
- Add CSS variables for animation timings: `--duration-fast`, `--duration-normal`, `--duration-slow`
- Add CSS variables for easing functions: `--ease-out-expo`, `--ease-in-out-quad`
- Create utility classes for common transitions: `.transition-state`, `.transition-appearance`
- Ensure all new animations respect `prefers-reduced-motion`

**Files**: `src/index.css`

### Task 2: Create ThinkingState component

**Goal**: Visual indicator for AI processing/thinking states

**Behavior:**
- Shows when AI is processing a request
- Uses brutalist aesthetic (no glow, hard edges)
- Options: pulse dots, typing indicator, or processing bars
- Must work with reduced motion (static fallback)

**Component API:**
```jsx
<ThinkingState
  variant="dots" | "typing" | "processing"
  size="sm" | "md" | "lg"
  label="Thinking..." // Optional accessible label
/>
```

**Files**: `src/components/animations/ThinkingState.jsx` (new)

### Task 3: Create ProgressIndicator component

**Goal**: Visual progress for multi-step AI operations

**Behavior:**
- Shows determinate progress (0-100%) or indeterminate
- Steps variant for multi-stage processes (e.g., "Listening → Processing → Responding")
- Brutalist styling: solid bars, hard edges, no gradients
- Accessible progress announcements

**Component API:**
```jsx
<ProgressIndicator
  value={75} // 0-100, or undefined for indeterminate
  steps={['Listen', 'Process', 'Respond']}
  currentStep={1}
  size="sm" | "md"
/>
```

**Files**: `src/components/animations/ProgressIndicator.jsx` (new)

### Task 4: Create ConfidenceDisplay component

**Goal**: Show AI confidence/certainty levels

**Behavior:**
- Displays percentage or level (high/medium/low)
- Visual bar or badge format
- Color coding: high=emerald, medium=amber, low=red
- Brutalist styling consistent with design system

**Component API:**
```jsx
<ConfidenceDisplay
  value={94} // 0-100
  format="percentage" | "level" | "bar"
  size="sm" | "md"
/>
```

**Files**: `src/components/animations/ConfidenceDisplay.jsx` (new)

### Task 5: Create StateTransition wrapper component

**Goal**: Animated transitions between UI states

**Behavior:**
- Wrap content that changes state (loading → loaded, hidden → visible)
- Support enter/exit animations
- Respect reduced motion preferences
- Options: fade, slide, scale

**Component API:**
```jsx
<StateTransition
  show={isVisible}
  enter="fade" | "slide-up" | "scale"
  duration="fast" | "normal"
>
  <Content />
</StateTransition>
```

**Files**: `src/components/animations/StateTransition.jsx` (new)

### Task 6: Create Waveform component (extract from VoiceDemo)

**Goal**: Reusable audio waveform visualization

**Behavior:**
- Extract existing waveform pattern from VoiceDemo
- Make configurable (bar count, color, animation state)
- Support paused/playing/inactive states
- Props for brand-blue or white accent

**Component API:**
```jsx
<Waveform
  state="playing" | "paused" | "inactive"
  color="brand" | "white"
  bars={16}
/>
```

**Files**:
- `src/components/animations/Waveform.jsx` (new)
- `src/components/VoiceDemo.jsx` (refactor to use new component)

### Task 7: Add animation keyframes to Tailwind config

**Goal**: Register new animations in Tailwind

**Changes:**
- Add `thinking-dots` keyframe (opacity pulse for dot indicators)
- Add `thinking-typing` keyframe (cursor blink for typing indicator)
- Add `progress-indeterminate` keyframe (sliding bar)
- Add `scale-in`, `fade-in`, `slide-up` keyframes for transitions
- Register all as Tailwind animations

**Files**: `tailwind.config.js`

### Task 8: Create animation component index and documentation

**Goal**: Organize exports and document usage

**Changes:**
- Create index file exporting all animation components
- Add JSDoc comments with usage examples
- Document reduced motion behavior
- Create simple ANIMATIONS.md documentation

**Files**:
- `src/components/animations/index.js` (new)
- `src/styles/ANIMATIONS.md` (new)

### Task 9: Integrate ThinkingState into VoiceDemo

**Goal**: Add thinking indicator to demo cards

**Changes:**
- Add thinking state when "processing" a request (mock state for now)
- Show ThinkingState below waveform during processing
- Add subtle state transition when switching states
- Maintain brutalist card styling

**Files**: `src/components/VoiceDemo.jsx`

### Task 10: Add loading states to page sections

**Goal**: Placeholder states while content "loads"

**Changes:**
- Add simple skeleton/loading variants to key sections (Hero stats, VoiceDemo cards)
- Use StateTransition for appear animations on scroll
- Keep it subtle — brutalist aesthetic, no flashy effects
- Consider intersection observer for scroll-triggered animations

**Files**:
- `src/components/Hero.jsx`
- `src/components/VoiceDemo.jsx`

### Task 11: Build and lint verification

**Goal**: Ensure all changes are valid

**Verification:**
- Run `npm run build` — no errors
- Run `npm run lint` — no new warnings
- Test reduced motion behavior (browser DevTools)
- Visual review of all new components

## Success Criteria

- [ ] Animation timing CSS variables defined and documented
- [ ] ThinkingState component created with 3 variants
- [ ] ProgressIndicator component created with step support
- [ ] ConfidenceDisplay component created with bar/badge formats
- [ ] StateTransition wrapper handles enter/exit animations
- [ ] Waveform extracted as reusable component
- [ ] All animations respect `prefers-reduced-motion`
- [ ] Tailwind keyframes registered for new animations
- [ ] Animation components documented in ANIMATIONS.md
- [ ] VoiceDemo enhanced with thinking state
- [ ] Build and lint pass with no errors

## Output

- New directory: `src/components/animations/`
- New files:
  - `src/components/animations/ThinkingState.jsx`
  - `src/components/animations/ProgressIndicator.jsx`
  - `src/components/animations/ConfidenceDisplay.jsx`
  - `src/components/animations/StateTransition.jsx`
  - `src/components/animations/Waveform.jsx`
  - `src/components/animations/index.js`
  - `src/styles/ANIMATIONS.md`
- Updated files:
  - `src/index.css` (animation timing variables)
  - `tailwind.config.js` (new keyframes)
  - `src/components/VoiceDemo.jsx` (use Waveform, add ThinkingState)
  - `src/components/Hero.jsx` (optional loading states)
- Updated `.planning/phases/04-animation-state-system/04-01-SUMMARY.md`
- Updated `.planning/STATE.md` with progress
